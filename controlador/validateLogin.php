<?phprequire_once '../modelo/conexiondb.php';require_once '../modelo/Historial_modelo.php';require_once '../modelo/Usuarios_modelo.php'; $usuario = trim($_POST["usuario"]);  $user_input = trim($_POST["clave"]);    $conn = conexion::getInstance();    $usuarios = new Usuarios();  $row = $usuarios->getDatosUsuario($usuario);    //$hashedPass = $row["clave"];    $hash = $row['clave']; if($row != NULL){        if (password_verify($user_input, $hash)) {      session_start();      $_SESSION["sesion4"]["idusuario"] = $row["idusuario"];       $_SESSION["sesion4"]["usuario"] = $row["usuario"];       $_SESSION["sesion4"]["nombre"] = $row["nombre"];      $_SESSION["sesion4"]["apellido"] = $row["apellido"];      $_SESSION["sesion4"]["tipousuario"] = $row['tipousuario'];      $_SESSION["sesion4"]["foto"]=$row['foto'];      $res = $conn->query("SELECT nombretipo FROM tipousuario WHERE idtipousuario = '".$row['tipousuario']."'");      $row = $res->fetch_assoc();      $_SESSION["sesion4"]["nombretipo"] = $row["nombretipo"];      // MANEJO DEL INGRESO AL SISTEMA EN LA BITACORA****************************************************************************      $array = [      "idusuario" => $_SESSION["sesion4"]["idusuario"],      "detalle" => "Ingreso al sistema del usuario: " .$_SESSION["sesion4"]["usuario"]. "",      ];      $log = new Historial();      $log1 = $log->agregarLog( $array );      //****************************************************************************************************************************      switch ($_SESSION["sesion4"]["tipousuario"]) {      	case 1:       	  header('Location: ../vista/indexAdmin.php');      	  break;      }          }else {      header("Location: ../vista/index.php?error=1"); //CLAVE INCORRECTA      exit();    }  }else {           /* NO EXISTE USUARIO MANDAR ERROR  */      header("Location: ../vista/index.php?error=2");      exit();    }